import ballerina/grpc;
import ballerina/log;

listener grpc:Listener ep = new (9090);



service caliSystemService on ep {
    //The implementation here ia to allow is for entries to be held in memory during the system running
    resource function addRecord(grpc:Caller caller, RecordInfo value,json content, string path) {
        map<RecordInfo> recordmap = {};

        string ID = value.RecID;
        recordmap[value.RecID] = value;

        string payload = "Recorcd Created, ID is " + ID;

        error? result = caller->send(payload);
        result = caller->complete();
        if (result is error) {
            log:printError("Error from Connector: " + result.reason() + " - " + <string>result.detail()["message"] + "\n");
        }
        
    }
    
    resource function updateRecord(grpc:Caller caller, RecordInfo value) {
        // Implementation goes here.

        // You should return a string
    }
    resource function viewRecord(grpc:Caller caller, string value) {
        // Implementation goes here.

        // You should return a string
    }
}

public type RecordInfo record {|
    string RecID = "";
    string artistName = "";
    string artistMembership = "";
    string songTitle = "";
    string songGenre = "";
    string songPlatform = "";
    string band = "";
    string date = "";
    
|};



const string ROOT_DESCRIPTOR = "0A0D43616C695379732E70726F746F120B677270635F7365726976651A1E676F6F676C652F70726F746F6275662F77726170706572732E70726F746F22F6010A0A5265636F7264496E666F12140A05526563494418012001280952055265634944121E0A0A6172746973744E616D65180220012809520A6172746973744E616D65122A0A106172746973744D656D6265727368697018032001280952106172746973744D656D62657273686970121C0A09736F6E675469746C651805200128095209736F6E675469746C65121C0A09736F6E6747656E72651806200128095209736F6E6747656E726512220A0C736F6E67506C6174666F726D180720012809520C736F6E67506C6174666F726D12120A0462616E64180820012809520462616E6412120A046461746518092001280952046461746532E8010A1163616C6953797374656D5365727669636512420A096164645265636F726412172E677270635F7365726976652E5265636F7264496E666F1A1C2E676F6F676C652E70726F746F6275662E537472696E6756616C756512450A0C7570646174655265636F726412172E677270635F7365726976652E5265636F7264496E666F1A1C2E676F6F676C652E70726F746F6275662E537472696E6756616C756512480A0A766965775265636F7264121C2E676F6F676C652E70726F746F6275662E537472696E6756616C75651A1C2E676F6F676C652E70726F746F6275662E537472696E6756616C7565620670726F746F33";
function getDescriptorMap() returns map<string> {
    return {
        "CaliSys.proto":"0A0D43616C695379732E70726F746F120B677270635F7365726976651A1E676F6F676C652F70726F746F6275662F77726170706572732E70726F746F22F6010A0A5265636F7264496E666F12140A05526563494418012001280952055265634944121E0A0A6172746973744E616D65180220012809520A6172746973744E616D65122A0A106172746973744D656D6265727368697018032001280952106172746973744D656D62657273686970121C0A09736F6E675469746C651805200128095209736F6E675469746C65121C0A09736F6E6747656E72651806200128095209736F6E6747656E726512220A0C736F6E67506C6174666F726D180720012809520C736F6E67506C6174666F726D12120A0462616E64180820012809520462616E6412120A046461746518092001280952046461746532E8010A1163616C6953797374656D5365727669636512420A096164645265636F726412172E677270635F7365726976652E5265636F7264496E666F1A1C2E676F6F676C652E70726F746F6275662E537472696E6756616C756512450A0C7570646174655265636F726412172E677270635F7365726976652E5265636F7264496E666F1A1C2E676F6F676C652E70726F746F6275662E537472696E6756616C756512480A0A766965775265636F7264121C2E676F6F676C652E70726F746F6275662E537472696E6756616C75651A1C2E676F6F676C652E70726F746F6275662E537472696E6756616C7565620670726F746F33",
        "google/protobuf/wrappers.proto":"0A1E676F6F676C652F70726F746F6275662F77726170706572732E70726F746F120F676F6F676C652E70726F746F62756622230A0B446F75626C6556616C756512140A0576616C7565180120012801520576616C756522220A0A466C6F617456616C756512140A0576616C7565180120012802520576616C756522220A0A496E74363456616C756512140A0576616C7565180120012803520576616C756522230A0B55496E74363456616C756512140A0576616C7565180120012804520576616C756522220A0A496E74333256616C756512140A0576616C7565180120012805520576616C756522230A0B55496E74333256616C756512140A0576616C756518012001280D520576616C756522210A09426F6F6C56616C756512140A0576616C7565180120012808520576616C756522230A0B537472696E6756616C756512140A0576616C7565180120012809520576616C756522220A0A427974657356616C756512140A0576616C756518012001280C520576616C756542570A13636F6D2E676F6F676C652E70726F746F627566420D577261707065727350726F746F50015A057479706573F80101A20203475042AA021E476F6F676C652E50726F746F6275662E57656C6C4B6E6F776E5479706573620670726F746F33"
        
    };
}

